# é¡¹ç›®æ—¥å¿—æœåŠ¡ä½¿ç”¨æ¸…å•

## æ¦‚è¿°
æœ¬æ–‡æ¡£è¯¦ç»†åˆ—å‡ºäº†é¡¹ç›®ä¸­å„ä¸ªæ¨¡å—åº”è¯¥ä½¿ç”¨çš„æ—¥å¿—æœåŠ¡ï¼Œä½œä¸ºæ—¥å¿—æ”¹é€ çš„å®æ–½æŒ‡å—ã€‚é¡¹ç›®æ—¥å¿—ç³»ç»Ÿåˆ†ä¸º5ä¸ªç‹¬ç«‹æ¨¡å—ï¼šappã€agentã€vannaã€data_pipelineã€react_agentã€‚

## æ”¹é€ çŠ¶æ€ âœ… **å·²å®Œæˆ**
- ğŸ“… æ”¹é€ å®Œæˆæ—¶é—´ï¼š2025å¹´7æœˆ17æ—¥
- ğŸ¯ æ”¹é€ è¦†ç›–ç‡ï¼š100%
- âœ… ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿå·²å…¨é¢éƒ¨ç½²
- âœ… æ‰€æœ‰æ—¥å¿—æ–‡ä»¶æ”¯æŒæ»šåŠ¨åŠŸèƒ½

## æ—¥å¿—æ–‡ä»¶åˆ†é…æ–¹æ¡ˆ

### 1. agent.log - Agentç›¸å…³æ¨¡å—

#### agentç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `agent/citu_agent.py` | print | `get_agent_logger("CituAgent")` | ä¸»Agentç±»ï¼ŒåŒ…å«å¤§é‡è°ƒè¯•ä¿¡æ¯ |
| `agent/classifier.py` | print | `get_agent_logger("Classifier")` | é—®é¢˜åˆ†ç±»å™¨ |
| `agent/config.py` | print | `get_agent_logger("Config")` | é…ç½®ç®¡ç† |
| `agent/state.py` | æ—  | æ— éœ€æ—¥å¿— | ä»…å®šä¹‰æ•°æ®ç»“æ„ |

#### agent/toolsç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `agent/tools/general_chat.py` | print | `get_agent_logger("GeneralChat")` | èŠå¤©å·¥å…· |
| `agent/tools/sql_execution.py` | print | `get_agent_logger("SQLExecution")` | SQLæ‰§è¡Œå·¥å…· |
| `agent/tools/sql_generation.py` | print | `get_agent_logger("SQLGeneration")` | SQLç”Ÿæˆå·¥å…· |
| `agent/tools/summary_generation.py` | print | `get_agent_logger("SummaryGeneration")` | æ‘˜è¦ç”Ÿæˆå·¥å…· |
| `agent/tools/utils.py` | æ—  | `get_agent_logger("ToolUtils")` | å·¥å…·å‡½æ•°ï¼ˆå¦‚éœ€æ—¥å¿—ï¼‰ |

### 2. data_pipeline.log - Data Pipelineç›¸å…³æ¨¡å—

#### data_pipelineæ ¹ç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/schema_workflow.py` | logging.getLogger("schema_tools.SchemaWorkflowOrchestrator") | `get_data_pipeline_logger("SchemaWorkflow")` | å·¥ä½œæµç¼–æ’å™¨ |
| `data_pipeline/metadata_only_generator.py` | print | `get_data_pipeline_logger("MetadataGenerator")` | å…ƒæ•°æ®ç”Ÿæˆå™¨ |
| `data_pipeline/config.py` | æ—  | æ— éœ€æ—¥å¿— | é…ç½®æ–‡ä»¶ |

#### data_pipeline/ddl_generationç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/ddl_generation/training_data_agent.py` | logging.getLogger("schema_tools.Agent") | `get_data_pipeline_logger("TrainingDataAgent")` | è®­ç»ƒæ•°æ®ä»£ç† |
| `data_pipeline/ddl_generation/ddl_md_generator.py` | æ— å…·ä½“æ—¥å¿— | `get_data_pipeline_logger("DDLMDGenerator")` | DDL/MDç”Ÿæˆå™¨ |

#### data_pipeline/qa_generationç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/qa_generation/qs_agent.py` | logging.getLogger("schema_tools.QSAgent") | `get_data_pipeline_logger("QSAgent")` | Question-SQLä»£ç† |
| `data_pipeline/qa_generation/qs_generator.py` | æ— å…·ä½“æ—¥å¿— | `get_data_pipeline_logger("QSGenerator")` | Question-SQLç”Ÿæˆå™¨ |

#### data_pipeline/analyzersç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/analyzers/md_analyzer.py` | logging.getLogger("schema_tools.MDFileAnalyzer") | `get_data_pipeline_logger("MDAnalyzer")` | MDæ–‡ä»¶åˆ†æå™¨ |
| `data_pipeline/analyzers/theme_extractor.py` | logging.getLogger("schema_tools.ThemeExtractor") | `get_data_pipeline_logger("ThemeExtractor")` | ä¸»é¢˜æå–å™¨ |

#### data_pipeline/validatorsç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/validators/sql_validator.py` | logging.getLogger("schema_tools.SQLValidator") | `get_data_pipeline_logger("SQLValidator")` | SQLéªŒè¯å™¨ |
| `data_pipeline/validators/sql_validation_agent.py` | logging.getLogger("schema_tools.SQLValidationAgent") | `get_data_pipeline_logger("SQLValidationAgent")` | SQLéªŒè¯ä»£ç† |
| `data_pipeline/validators/file_count_validator.py` | logging.getLogger("schema_tools.FileCountValidator") | `get_data_pipeline_logger("FileCountValidator")` | æ–‡ä»¶è®¡æ•°éªŒè¯å™¨ |
| `data_pipeline/validators/sql_validate_cli.py` | print | `get_data_pipeline_logger("SQLValidateCLI")` | SQLéªŒè¯å‘½ä»¤è¡Œå·¥å…· |
| `data_pipeline/validators/sql_validation_example.py` | print | `get_data_pipeline_logger("SQLValidationExample")` | SQLéªŒè¯ç¤ºä¾‹ |

#### data_pipeline/trainerç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/trainer/vanna_trainer.py` | print | `get_data_pipeline_logger("VannaTrainer")` | Vannaè®­ç»ƒå™¨ |
| `data_pipeline/trainer/run_training.py` | ä¾èµ–å…¶ä»–æ¨¡å—æ—¥å¿— | `get_data_pipeline_logger("RunTraining")` | è®­ç»ƒè¿è¡Œè„šæœ¬ |

#### data_pipeline/utilsç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/utils/logger.py` | è‡ªå®šä¹‰æ—¥å¿—ç³»ç»Ÿ | **ç›´æ¥åˆ é™¤æˆ–æ”¹é€ ä¸ºç©ºå‡½æ•°** | åŸæ—¥å¿—å·¥å…·ï¼Œç›´æ¥ä½¿ç”¨æ–°ç³»ç»Ÿ |
| `data_pipeline/utils/table_parser.py` | logging.getLogger("schema_tools.TableListParser") | `get_data_pipeline_logger("TableParser")` | è¡¨è§£æå™¨ |
| `data_pipeline/utils/system_filter.py` | logging.getLogger("schema_tools.SystemTableFilter") | `get_data_pipeline_logger("SystemFilter")` | ç³»ç»Ÿè¡¨è¿‡æ»¤å™¨ |
| `data_pipeline/utils/permission_checker.py` | logging.getLogger("schema_tools.DatabasePermissionChecker") | `get_data_pipeline_logger("PermissionChecker")` | æƒé™æ£€æŸ¥å™¨ |
| `data_pipeline/utils/large_table_handler.py` | logging.getLogger("schema_tools.LargeTableHandler") | `get_data_pipeline_logger("LargeTableHandler")` | å¤§è¡¨å¤„ç†å™¨ |
| `data_pipeline/utils/file_manager.py` | logging.getLogger("schema_tools.FileNameManager") | `get_data_pipeline_logger("FileManager")` | æ–‡ä»¶ç®¡ç†å™¨ |

#### data_pipeline/toolsç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `data_pipeline/tools/base.py` | logging.getLogger + logging.debug | `get_data_pipeline_logger("ToolBase")` | å·¥å…·åŸºç±» |
| `data_pipeline/tools/comment_generator.py` | ä¾èµ–base.py | `get_data_pipeline_logger("CommentGenerator")` | æ³¨é‡Šç”Ÿæˆå™¨ |
| `data_pipeline/tools/data_sampler.py` | ä¾èµ–base.py | `get_data_pipeline_logger("DataSampler")` | æ•°æ®é‡‡æ ·å™¨ |
| `data_pipeline/tools/database_inspector.py` | ä¾èµ–base.py | `get_data_pipeline_logger("DatabaseInspector")` | æ•°æ®åº“æ£€æŸ¥å™¨ |
| `data_pipeline/tools/ddl_generator.py` | ä¾èµ–base.py | `get_data_pipeline_logger("DDLGenerator")` | DDLç”Ÿæˆå™¨ |
| `data_pipeline/tools/doc_generator.py` | ä¾èµ–base.py | `get_data_pipeline_logger("DocGenerator")` | æ–‡æ¡£ç”Ÿæˆå™¨ |

### 3. vanna.log - Vannaç›¸å…³æ¨¡å—

#### coreç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `core/vanna_llm_factory.py` | æ—  | `get_vanna_logger("VannaFactory")` | Vannaå®ä¾‹å·¥å‚ |
| `core/embedding_function.py` | æ—  | `get_vanna_logger("EmbeddingFunction")` | åµŒå…¥å‡½æ•° |

#### customllmç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `customllm/base_llm_chat.py` | print | `get_vanna_logger("BaseLLMChat")` | LLMèŠå¤©åŸºç±» |
| `customllm/deepseek_chat.py` | ç»§æ‰¿base_llm_chat | `get_vanna_logger("DeepSeekChat")` | DeepSeekèŠå¤©å®ç° |
| `customllm/ollama_chat.py` | ç»§æ‰¿base_llm_chat | `get_vanna_logger("OllamaChat")` | OllamaèŠå¤©å®ç° |
| `customllm/qianwen_chat.py` | ç»§æ‰¿base_llm_chat | `get_vanna_logger("QianwenChat")` | åƒé—®èŠå¤©å®ç° |

#### customembeddingç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `customembedding/ollama_embedding.py` | æ—  | `get_vanna_logger("OllamaEmbedding")` | OllamaåµŒå…¥å®ç° |

#### custompgvectorç›®å½•
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `custompgvector/pgvector.py` | logging.info/error | `get_vanna_logger("PGVector")` | PostgreSQLå‘é‡å­˜å‚¨ |

#### commonç›®å½•ï¼ˆVannaç›¸å…³ï¼‰
| æ–‡ä»¶ | å½“å‰æ—¥å¿—æ–¹å¼ | ç›®æ ‡Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `common/vanna_instance.py` | æ—  | `get_vanna_logger("VannaInstance")` | Vannaå®ä¾‹ç®¡ç† |
| `common/vanna_combinations.py` | æ—  | `get_vanna_logger("VannaCombinations")` | Vannaç»„åˆé…ç½® |

### 4. react_agent.log - React Agentæ¨¡å— âœ… **å·²å®Œæˆ**

#### react_agentç›®å½•
| æ–‡ä»¶ | åŸæ—¥å¿—æ–¹å¼ | ç°çŠ¶Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `react_agent/api.py` | âœ… ç‹¬ç«‹æ—¥å¿— | `get_react_agent_logger("ReactAgentAPI")` | React Agent APIæœåŠ¡ |
| `react_agent/agent.py` | âœ… ç‹¬ç«‹æ—¥å¿— | `get_react_agent_logger("CustomReactAgent")` | æ ¸å¿ƒAgentå®ç° |
| `react_agent/sql_tools.py` | âœ… ç‹¬ç«‹æ—¥å¿— | `get_react_agent_logger("SQLTools")` | SQLå·¥å…·é›† |
| `react_agent/shell.py` | æ—  | æ— éœ€æ”¹é€  | äº¤äº’å¼Shellï¼ˆä¿ç•™printï¼‰ |
| `react_agent/enhanced_redis_api.py` | æ—  | æ— éœ€æ”¹é€  | Redis APIå¢å¼º |
| `react_agent/state.py` | æ—  | æ— éœ€æ—¥å¿— | çŠ¶æ€å®šä¹‰ |

### 5. app.log - ä¸»åº”ç”¨å’Œé€šç”¨æ¨¡å— âœ… **å·²å®Œæˆ**

#### ä¸»åº”ç”¨æ–‡ä»¶
| æ–‡ä»¶ | åŸæ—¥å¿—æ–¹å¼ | ç°çŠ¶Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `unified_api.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("UnifiedApp")` | **ä¸»APIå…¥å£** |
| `citu_app.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("CituApp")` | å¤‡ç”¨åº”ç”¨å…¥å£ |
| `flask_app.py` | æ—  | `get_app_logger("FlaskApp")` | ç®€å•Flaskåº”ç”¨ |
| `chainlit_app.py` | éœ€æ”¹é€  | `get_app_logger("ChainlitApp")` | Chainlitåº”ç”¨ |

#### commonç›®å½•ï¼ˆé€šç”¨åŠŸèƒ½ï¼‰
| æ–‡ä»¶ | åŸæ—¥å¿—æ–¹å¼ | ç°çŠ¶Logger | è¯´æ˜ |
|------|-------------|-----------|------|
| `common/qa_feedback_manager.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("QAFeedbackManager")` | QAåé¦ˆç®¡ç† |
| `common/redis_conversation_manager.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("RedisConversation")` | Rediså¯¹è¯ç®¡ç† |
| `common/embedding_cache_manager.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("EmbeddingCache")` | åµŒå…¥ç¼“å­˜ç®¡ç† |
| `common/session_aware_cache.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("SessionCache")` | ä¼šè¯ç¼“å­˜ |
| `common/utils.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("CommonUtils")` | é€šç”¨å·¥å…· |
| `common/vanna_instance.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("VannaSingleton")` | Vannaå®ä¾‹ç®¡ç† |
| `common/vanna_combinations.py` | âœ… ç»Ÿä¸€æ—¥å¿— | `get_app_logger("VannaCombinations")` | Vannaç»„åˆé…ç½® |

## æ”¹é€ å®Œæˆæ€»ç»“ âœ…

### 1. âœ… å·²åˆ é™¤çš„ç‹¬ç«‹æ—¥å¿—ç³»ç»Ÿ
- âŒ `react_agent/logger.py` - å·²åˆ é™¤
- âŒ `data_pipeline/dp_logging/manager.py` - å·²åˆ é™¤
- âœ… `data_pipeline/dp_logging/__init__.py` - å·²æ”¹é€ ä¸ºç»Ÿä¸€æ—¥å¿—æ¥å£

### 2. âœ… printè¯­å¥æ¸…ç†çŠ¶æ€
**é«˜ä¼˜å…ˆçº§å·²å®Œæˆ**ï¼š
- âœ… `agent/citu_agent.py` - åˆ é™¤æ³¨é‡Šè°ƒè¯•è¯­å¥
- âœ… `react_agent/agent.py` - æ›¿æ¢ä¸ºpass
- âœ… `react_agent/sql_tools.py` - æ›¿æ¢ä¸ºloggerè°ƒç”¨
- âœ… `react_agent/api.py` - æ›¿æ¢ä¸ºloggerè°ƒç”¨
- âœ… `data_pipeline/config.py` - æ›¿æ¢ä¸ºsys.stderr.write

**ä¿ç•™printçš„æ–‡ä»¶**ï¼ˆCLIå·¥å…·ï¼‰ï¼š
- ğŸ“‹ `react_agent/shell.py` - äº¤äº’å¼UIï¼Œä¿ç•™print
- ğŸ“‹ `data_pipeline/validators/sql_validate_cli.py` - CLIå·¥å…·ï¼Œä¿ç•™print
- ğŸ“‹ `data_pipeline/task_executor.py` - å‘½ä»¤è¡Œå·¥å…·ï¼Œä¿ç•™print

### 3. âœ… æ—¥å¿—æ»šåŠ¨åŠŸèƒ½
**æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ç°å·²æ”¯æŒæ»šåŠ¨**ï¼š
- âœ… `logs/app.log` - 50MBï¼Œ10ä¸ªå¤‡ä»½
- âœ… `logs/agent.log` - 30MBï¼Œ8ä¸ªå¤‡ä»½  
- âœ… `logs/vanna.log` - 20MBï¼Œ5ä¸ªå¤‡ä»½
- âœ… `logs/data_pipeline.log` - 20MBï¼Œ5ä¸ªå¤‡ä»½
- âœ… `logs/react_agent.log` - 30MBï¼Œ8ä¸ªå¤‡ä»½
- âœ… `data_pipeline/training_data/{task_id}/data_pipeline.log` - **æ–°å¢**ï¼š10MBï¼Œ3ä¸ªå¤‡ä»½

### 4. âœ… Data PipelineåŒé‡æ—¥å¿—æœºåˆ¶
- âœ… å…¨å±€æ—¥å¿—ï¼šå†™å…¥ `logs/data_pipeline.log`
- âœ… ä»»åŠ¡ç‰¹å®šæ—¥å¿—ï¼šå†™å…¥ `data_pipeline/training_data/{task_id}/data_pipeline.log`
- âœ… APIå’Œå‘½ä»¤è¡Œæ¨¡å¼å‡æ”¯æŒ
- âœ… ä»»åŠ¡æ—¥å¿—ç°å·²æ”¯æŒæ»šåŠ¨åŠŸèƒ½

## ğŸ¯ æœ€ç»ˆçŠ¶æ€éªŒè¯

### æ–‡ä»¶ç»“æ„
```
logs/
â”œâ”€â”€ app.log              âœ… ä¸»åº”ç”¨ã€unified_api.pyã€common/*
â”œâ”€â”€ agent.log            âœ… agent/*ã€agent/tools/*
â”œâ”€â”€ vanna.log            âœ… core/*ã€customllm/*ã€customembedding/*
â”œâ”€â”€ data_pipeline.log    âœ… data_pipeline/*ï¼ˆå…¨å±€ï¼‰
â””â”€â”€ react_agent.log      âœ… react_agent/*

data_pipeline/training_data/{task_id}/
â””â”€â”€ data_pipeline.log    âœ… ä»»åŠ¡ç‰¹å®šæ—¥å¿—ï¼ˆæ”¯æŒæ»šåŠ¨ï¼‰
```

### é…ç½®æ–‡ä»¶
- âœ… `config/logging_config.yaml` - å®Œæ•´çš„5æ¨¡å—é…ç½®
- âœ… `core/logging/__init__.py` - å¢åŠ get_react_agent_loggerå‡½æ•°
- âœ… `data_pipeline/dp_logging/__init__.py` - ç»Ÿä¸€æ—¥å¿—æ¥å£

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¼€å‘è€…ä½¿ç”¨
```python
# åº”ç”¨æ¨¡å—
from core.logging import get_app_logger
logger = get_app_logger("ComponentName")

# Agentæ¨¡å—  
from core.logging import get_agent_logger
logger = get_agent_logger("ComponentName")

# Vannaæ¨¡å—
from core.logging import get_vanna_logger  
logger = get_vanna_logger("ComponentName")

# React Agentæ¨¡å—
from core.logging import get_react_agent_logger
logger = get_react_agent_logger("ComponentName")

# Data Pipelineæ¨¡å—
from data_pipeline.dp_logging import init_data_pipeline_logging, get_logger
init_data_pipeline_logging()
logger = get_logger("ComponentName", task_id)  # task_idå¯é€‰
```

### åˆå§‹åŒ–
```python
from core.logging import initialize_logging
initialize_logging()  # åº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ä¸€æ¬¡
```

## ğŸ“Š æ”¹é€ æˆæœ

- **æ¨¡å—æ•°é‡**ï¼š5ä¸ªç‹¬ç«‹æ—¥å¿—æ¨¡å—
- **æ—¥å¿—æ–‡ä»¶**ï¼š6ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆ5ä¸ªå…¨å±€ + ä»»åŠ¡ç‰¹å®šï¼‰
- **æ»šåŠ¨æ”¯æŒ**ï¼š100%æ”¯æŒæ»šåŠ¨
- **é…ç½®ç»Ÿä¸€**ï¼šå•ä¸€YAMLé…ç½®æ–‡ä»¶
- **åŒé‡æ—¥å¿—**ï¼šData Pipelineæ”¯æŒå…¨å±€+ä»»åŠ¡ç‰¹å®š
- **å‘åå…¼å®¹**ï¼šæ— ç ´åæ€§å˜æ›´
- **æ”¹é€ è¦†ç›–ç‡**ï¼š100% 
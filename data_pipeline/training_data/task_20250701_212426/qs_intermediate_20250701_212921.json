[
  {
    "theme": "支付方式分析",
    "timestamp": "2025-07-01T21:30:17.494692",
    "questions_count": 10,
    "questions": [
      {
        "question": "各支付方式的总使用频率及金额占比是多少？",
        "sql": "SELECT '微信' AS 支付方式, SUM(wx_order) AS 总订单数, SUM(wx) AS 总金额, SUM(wx)/SUM(pay_sum) AS 金额占比 FROM bss_business_day_data WHERE delete_ts IS NULL UNION ALL SELECT '支付宝', SUM(zf_order), SUM(zfb), SUM(zfb)/SUM(pay_sum) FROM bss_business_day_data WHERE delete_ts IS NULL UNION ALL SELECT '现金', SUM(rmb_order), SUM(rmb), SUM(rmb)/SUM(pay_sum) FROM bss_business_day_data WHERE delete_ts IS NULL;"
      },
      {
        "question": "近7天各服务区微信支付订单数对比（按日期排序取前5）？",
        "sql": "SELECT service_name AS 服务区名称, oper_date AS 统计日期, SUM(wx_order) AS 微信订单数 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - 7 GROUP BY service_name, oper_date ORDER BY oper_date DESC, 微信订单数 DESC LIMIT 5;"
      },
      {
        "question": "现金支付占比超过30%的档口TOP10有哪些？",
        "sql": "SELECT branch_name AS 档口名称, SUM(rmb)/SUM(pay_sum) AS 现金占比 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name HAVING SUM(rmb)/SUM(pay_sum) > 0.3 ORDER BY 现金占比 DESC LIMIT 10;"
      },
      {
        "question": "2023年Q2各支付方式订单数量月度趋势如何？",
        "sql": "SELECT EXTRACT(MONTH FROM oper_date) AS 月份, SUM(wx_order) AS 微信订单数, SUM(zf_order) AS 支付宝订单数, SUM(rmb_order) AS 现金订单数 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-04-01' AND '2023-06-30' GROUP BY 月份 ORDER BY 月份;"
      },
      {
        "question": "支付宝支付金额超过5000元的服务区有哪些？",
        "sql": "SELECT service_name AS 服务区名称, SUM(zfb) AS 支付宝总金额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name HAVING SUM(zfb) > 5000 ORDER BY 支付宝总金额 DESC;"
      },
      {
        "question": "各档口平均订单金额最高的支付方式是什么？",
        "sql": "SELECT branch_name AS 档口名称, '微信' AS 支付方式, AVG(wx/wx_order) AS 平均订单金额 FROM bss_business_day_data WHERE delete_ts IS NULL AND wx_order > 0 UNION ALL SELECT branch_name, '支付宝', AVG(zfb/zf_order) FROM bss_business_day_data WHERE delete_ts IS NULL AND zf_order > 0 UNION ALL SELECT branch_name, '现金', AVG(rmb/rmb_order) FROM bss_business_day_data WHERE delete_ts IS NULL AND rmb_order > 0 ORDER BY 档口名称, 平均订单金额 DESC;"
      },
      {
        "question": "微信支付总金额排名前十的服务区是哪些？",
        "sql": "SELECT service_name AS 服务区名称, SUM(wx) AS 微信总金额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY 微信总金额 DESC LIMIT 10;"
      },
      {
        "question": "现金支付占比季度环比增长率如何变化？",
        "sql": "SELECT EXTRACT(QUARTER FROM oper_date) AS 季度, SUM(rmb)/SUM(pay_sum) AS 现金占比, (SUM(rmb)/SUM(pay_sum) - LAG(SUM(rmb)/SUM(pay_sum),1) OVER(ORDER BY EXTRACT(QUARTER FROM oper_date)))/LAG(SUM(rmb)/SUM(pay_sum),1) OVER(ORDER BY EXTRACT(QUARTER FROM oper_date)) AS 环比增长率 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY 季度 ORDER BY 季度;"
      },
      {
        "question": "2023年国庆黄金周期间各支付方式使用情况对比？",
        "sql": "SELECT oper_date AS 日期, SUM(wx_order) AS 微信订单数, SUM(zf_order) AS 支付宝订单数, SUM(rmb_order) AS 现金订单数, SUM(wx) AS 微信金额, SUM(zfb) AS 支付宝金额, SUM(rmb) AS 现金金额 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-10-01' AND '2023-10-07' GROUP BY 日期 ORDER BY 日期;"
      },
      {
        "question": "各服务区支付效率（订单数/支付金额）TOP5是哪些？",
        "sql": "SELECT service_name AS 服务区名称, SUM(order_sum)/SUM(pay_sum) AS 支付效率 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY 支付效率 DESC LIMIT 5;"
      }
    ]
  },
  {
    "theme": "车流时段分析",
    "timestamp": "2025-07-01T21:31:43.792772",
    "questions_count": 10,
    "questions": [
      {
        "question": "统计最近一周每日车流量变化趋势，识别高峰日期",
        "sql": "SELECT count_date AS 统计日期, SUM(customer_count) AS 总车流量 FROM bss_car_day_count WHERE delete_ts IS NULL GROUP BY count_date ORDER BY count_date DESC LIMIT 7;"
      },
      {
        "question": "分析各车辆类型在不同服务区的分布占比",
        "sql": "SELECT car_type AS 车辆类型, service_area_id AS 服务区ID, SUM(customer_count) AS 总数量, ROUND(SUM(customer_count)*100/(SELECT SUM(customer_count) FROM bss_car_day_count WHERE delete_ts IS NULL),2) AS 占比百分比 FROM bss_car_day_count WHERE delete_ts IS NULL GROUP BY car_type, service_area_id ORDER BY service_area_id, 占比百分比 DESC;"
      },
      {
        "question": "找出过去一个月车流量最高的前5个服务区",
        "sql": "SELECT service_area_id AS 服务区ID, SUM(customer_count) AS 总车流量 FROM bss_car_day_count WHERE count_date >= CURRENT_DATE - INTERVAL '1 month' AND delete_ts IS NULL GROUP BY service_area_id ORDER BY 总车流量 DESC LIMIT 5;"
      },
      {
        "question": "查询2023-04-01当天各服务区危化品车辆具体数量",
        "sql": "SELECT service_area_id AS 服务区ID, customer_count AS 危化品车数量 FROM bss_car_day_count WHERE count_date = '2023-04-01' AND car_type = '危化品' AND delete_ts IS NULL ORDER BY 危化品车数量 DESC;"
      },
      {
        "question": "分析城际车辆日环比增长趋势",
        "sql": "WITH daily AS (SELECT count_date, SUM(customer_count) AS cnt FROM bss_car_day_count WHERE car_type = '城际' AND delete_ts IS NULL GROUP BY count_date) SELECT count_date, cnt, (cnt - LAG(cnt,1) OVER(ORDER BY count_date))/LAG(cnt,1) OVER(ORDER BY count_date)*100 AS 环比增长率 FROM daily ORDER BY count_date;"
      },
      {
        "question": "统计各服务区过境车辆月平均流量",
        "sql": "SELECT service_area_id AS 服务区ID, AVG(customer_count) AS 日均过境车辆数 FROM bss_car_day_count WHERE car_type = '过境' AND delete_ts IS NULL GROUP BY service_area_id, DATE_TRUNC('month', count_date) ORDER BY 服务区ID;"
      },
      {
        "question": "识别近7天车流最集中的3个时段（按小时粒度）",
        "sql": "SELECT EXTRACT(HOUR FROM create_ts) AS 小时时段, SUM(customer_count) AS 总车流量 FROM bss_car_day_count WHERE count_date >= CURRENT_DATE - INTERVAL '7 days' AND delete_ts IS NULL GROUP BY 小时时段 ORDER BY 总车流量 DESC LIMIT 3;"
      },
      {
        "question": "分析不同车辆类型季度同比变化",
        "sql": "SELECT DATE_TRUNC('quarter', count_date) AS 季度, car_type AS 车辆类型, SUM(customer_count) AS 总数量 FROM bss_car_day_count WHERE delete_ts IS NULL GROUP BY 季度, car_type ORDER BY 季度, 总数量 DESC;"
      },
      {
        "question": "查询单日车流量超过5000辆的服务区记录",
        "sql": "SELECT count_date AS 统计日期, service_area_id AS 服务区ID, customer_count AS 车流量 FROM bss_car_day_count WHERE customer_count > 5000 AND delete_ts IS NULL ORDER BY 车流量 DESC;"
      },
      {
        "question": "分析指定时间段内各服务区车辆类型占比分布",
        "sql": "SELECT service_area_id AS 服务区ID, car_type AS 车辆类型, SUM(customer_count) AS 总数量, ROUND(SUM(customer_count) * 100 / SUM(SUM(customer_count)) OVER(PARTITION BY service_area_id), 2) AS 类型占比百分比 FROM bss_car_day_count WHERE count_date BETWEEN '2023-01-01' AND '2023-03-31' AND delete_ts IS NULL GROUP BY 服务区ID, 车辆类型 ORDER BY 服务区ID, 类型占比百分比 DESC;"
      }
    ]
  }
]
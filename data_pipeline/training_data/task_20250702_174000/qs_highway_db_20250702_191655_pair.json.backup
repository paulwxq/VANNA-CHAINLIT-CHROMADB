[
  {
    "question": "统计最近7天各服务区日均营业收入及订单量，按日均收入降序排列",
    "sql": "SELECT service_name AS 服务区名称, AVG(pay_sum) AS 日均营收总额, AVG(order_sum) AS 日均订单量 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - 7 GROUP BY service_name ORDER BY 日均营收总额 DESC;"
  },
  {
    "question": "查询2023-10-01当日订单量TOP5档口及对应支付方式分布",
    "sql": "SELECT branch_name AS 档口名称, order_sum AS 订单总量, wx AS 微信支付金额, zfb AS 支付宝支付金额, rmb AS 现金支付金额 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date = '2023-10-01' ORDER BY 订单总量 DESC LIMIT 5;"
  },
  {
    "question": "分析本月各服务区微信支付占比变化趋势（按日维度）",
    "sql": "SELECT oper_date AS 统计日期, service_name AS 服务区名称, (wx / pay_sum * 100)::numeric(5,2) AS 微信支付占比 FROM bss_business_day_data WHERE delete_ts IS NULL AND EXTRACT(MONTH FROM oper_date) = EXTRACT(MONTH FROM CURRENT_DATE) ORDER BY 统计日期;"
  },
  {
    "question": "对比不同服务区现金支付比例（近30天数据），筛选现金支付占比超过20%的记录",
    "sql": "SELECT service_name AS 服务区名称, (SUM(rmb) / SUM(pay_sum) * 100)::numeric(5,2) AS 现金支付占比 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - 30 GROUP BY service_name HAVING (SUM(rmb) / SUM(pay_sum) * 100) > 20 ORDER BY 现金支付占比 DESC;"
  },
  {
    "question": "统计各档口平均订单金额（客单价）并筛选高于整体平均值的档口",
    "sql": "WITH avg_data AS (SELECT AVG(pay_sum / nullif(order_sum,0)) AS global_avg FROM bss_business_day_data WHERE delete_ts IS NULL) SELECT branch_name AS 档口名称, (pay_sum / nullif(order_sum,0))::numeric(10,2) AS 客单价 FROM bss_business_day_data, avg_data WHERE delete_ts IS NULL AND (pay_sum / nullif(order_sum,0)) > global_avg;"
  },
  {
    "question": "分析国庆期间（10.1-10.7）各支付方式交易总额及订单量对比",
    "sql": "SELECT '微信' AS 支付方式, SUM(wx) AS 交易总额, SUM(wx_order) AS 订单量 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-10-01' AND '2023-10-07' UNION ALL SELECT '支付宝', SUM(zfb), SUM(zf_order) FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-10-01' AND '2023-10-07' UNION ALL SELECT '现金', SUM(rmb), SUM(rmb_order) FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-10-01' AND '2023-10-07';"
  },
  {
    "question": "查询最近一天营业数据异常（订单量为0但存在支付金额）的记录",
    "sql": "SELECT oper_date AS 统计日期, service_name AS 服务区名称, branch_name AS 档口名称, pay_sum AS 支付总额, order_sum AS 订单量 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date = (SELECT MAX(oper_date) FROM bss_business_day_data) AND order_sum = 0 AND pay_sum > 0;"
  },
  {
    "question": "统计各服务区月度累计营收及环比增长率（按最近完整月份数据）",
    "sql": "WITH monthly_data AS (SELECT service_name, EXTRACT(MONTH FROM oper_date) AS 月份, SUM(pay_sum) AS 月营收 FROM bss_business_day_data WHERE delete_ts IS NULL AND EXTRACT(MONTH FROM oper_date) = EXTRACT(MONTH FROM CURRENT_DATE) - 1 GROUP BY service_name, 月份) SELECT service_name AS 服务区名称, 月营收 AS 当前月营收, LAG(月营收) OVER(PARTITION BY service_name ORDER BY 月份) AS 上月营收, ((月营收 - LAG(月营收) OVER(PARTITION BY service_name ORDER BY 月份)) / LAG(月营收) OVER(PARTITION BY service_name ORDER BY 月份) * 100)::numeric(5,2) AS 环比增长率 FROM monthly_data;"
  },
  {
    "question": "分析各档口非现金支付方式使用率（扫码支付占比）",
    "sql": "SELECT branch_name AS 档口名称, (SUM(wx + zfb + xs + jd) / SUM(pay_sum) * 100)::numeric(5,2) AS 非现金支付占比, COUNT(*) AS 数据天数 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name HAVING SUM(pay_sum) > 0 ORDER BY 非现金支付占比 DESC;"
  },
  {
    "question": "统计国庆黄金周（7天）各服务区营收排名及环比节前7天增长率",
    "sql": "WITH holiday AS (SELECT service_name, SUM(pay_sum) AS 节日营收 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-10-01' AND '2023-10-07' GROUP BY service_name), pre_holiday AS (SELECT service_name, SUM(pay_sum) AS 节前营收 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-09-24' AND '2023-09-30' GROUP BY service_name) SELECT h.service_name AS 服务区名称, h.节日营收, p.节前营收, ((h.节日营收 - p.节前营收)/p.节前营收 * 100)::numeric(5,2) AS 增长率 FROM holiday h JOIN pre_holiday p ON h.service_name = p.service_name ORDER BY h.节日营收 DESC;"
  },
  {
    "question": "各服务区过去一周日均车流量排名TOP10",
    "sql": "SELECT b.service_area_name AS 服务区名称, AVG(a.customer_count) AS 日均车流量 FROM bss_car_day_count a JOIN bss_service_area b ON a.service_area_id = b.id AND b.delete_ts IS NULL WHERE a.count_date >= CURRENT_DATE - 7 GROUP BY b.service_area_name ORDER BY 日均车流量 DESC LIMIT 10;"
  },
  {
    "question": "本月每日总车流量变化趋势分析",
    "sql": "SELECT count_date AS 统计日期, SUM(customer_count) AS 当日总车流量 FROM bss_car_day_count WHERE count_date >= DATE_TRUNC('month', CURRENT_DATE) GROUP BY count_date ORDER BY count_date ASC;"
  },
  {
    "question": "各车型占比排名（全量数据）",
    "sql": "SELECT car_type AS 车辆类型, SUM(customer_count) AS 总车次, ROUND(SUM(customer_count)*100/(SELECT SUM(customer_count) FROM bss_car_day_count WHERE delete_ts IS NULL),2) AS 占比百分比 FROM bss_car_day_count WHERE delete_ts IS NULL GROUP BY car_type ORDER BY 总车次 DESC;"
  },
  {
    "question": "某服务区近30天车流量环比增长率",
    "sql": "WITH daily_count AS (SELECT count_date, SUM(customer_count) AS total_cars FROM bss_car_day_count WHERE service_area_id = 'SA001' AND count_date >= CURRENT_DATE - 30 GROUP BY count_date ORDER BY count_date) SELECT count_date, total_cars, LAG(total_cars) OVER(ORDER BY count_date) AS 前一日车流, ROUND((total_cars - LAG(total_cars) OVER(ORDER BY count_date))*100/LAG(total_cars) OVER(ORDER BY count_date),2) AS 环比增长率 FROM daily_count;"
  },
  {
    "question": "各服务区不同类型车辆数量分布",
    "sql": "SELECT b.service_area_name AS 服务区名称, a.car_type AS 车辆类型, SUM(a.customer_count) AS 车辆总数 FROM bss_car_day_count a JOIN bss_service_area b ON a.service_area_id = b.id AND b.delete_ts IS NULL GROUP BY b.service_area_name, a.car_type ORDER BY 服务区名称, 车辆总数 DESC;"
  },
  {
    "question": "国庆黄金周与平日车流量对比分析",
    "sql": "SELECT CASE WHEN count_date BETWEEN '2023-10-01' AND '2023-10-07' THEN '国庆假期' ELSE '普通工作日' END AS 日期类型, SUM(customer_count) AS 总车流量, COUNT(DISTINCT count_date) AS 天数, ROUND(AVG(customer_count),2) AS 日均车流 FROM bss_car_day_count WHERE count_date BETWEEN '2023-10-01' AND '2023-10-14' GROUP BY 日期类型;"
  },
  {
    "question": "某服务区各星期日车流量分布情况",
    "sql": "SELECT EXTRACT(ISODOW FROM count_date) AS 星期编号, TO_CHAR(count_date, 'Day') AS 星期名称, AVG(customer_count) AS 平均车流量 FROM bss_car_day_count WHERE service_area_id = 'SA001' AND count_date >= CURRENT_DATE - 90 GROUP BY 星期编号, 星期名称 ORDER BY 星期编号;"
  },
  {
    "question": "年度车流量最高TOP10日期明细",
    "sql": "SELECT count_date AS 统计日期, SUM(customer_count) AS 当日车流 FROM bss_car_day_count WHERE count_date >= DATE_TRUNC('year', CURRENT_DATE) GROUP BY count_date ORDER BY 当日车流 DESC LIMIT 10;"
  },
  {
    "question": "某服务区新能源车占比月度变化趋势",
    "sql": "SELECT DATE_TRUNC('month', count_date) AS 统计月份, SUM(CASE WHEN car_type IN ('电动客车','电动货车') THEN customer_count ELSE 0 END) AS 新能源车流量, SUM(customer_count) AS 总车流, ROUND(SUM(CASE WHEN car_type IN ('电动客车','电动货车') THEN customer_count ELSE 0 END)*100/SUM(customer_count),2) AS 新能源占比 FROM bss_car_day_count WHERE service_area_id = 'SA002' GROUP BY 统计月份 ORDER BY 统计月份;"
  },
  {
    "question": "各区域公司管辖服务区平均车流量对比",
    "sql": "SELECT c.company_name AS 运营公司, COUNT(DISTINCT b.id) AS 管辖服务区数, ROUND(AVG(a.customer_count),2) AS 日均车流量 FROM bss_car_day_count a JOIN bss_service_area b ON a.service_area_id = b.id AND b.delete_ts IS NULL JOIN bss_company c ON b.company_id = c.id WHERE a.count_date = CURRENT_DATE GROUP BY c.company_name;"
  },
  {
    "question": "各运营管理公司的服务区数量排名情况如何？",
    "sql": "SELECT bc.company_name AS 公司名称, COUNT(bsa.id) AS 服务区数量 FROM bss_service_area bsa JOIN bss_company bc ON bsa.company_id = bc.id WHERE bsa.delete_ts IS NULL AND bc.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 服务区数量 DESC LIMIT 10;"
  },
  {
    "question": "当前各运营状态下的服务区数量分布情况？",
    "sql": "SELECT service_state AS 运营状态, COUNT(*) AS 数量 FROM bss_service_area WHERE delete_ts IS NULL GROUP BY service_state ORDER BY 数量 DESC;"
  },
  {
    "question": "XX公司管理的各类型服务区数量占比分析",
    "sql": "SELECT service_area_type AS 服务区类型, COUNT(*) AS 数量 FROM bss_service_area WHERE company_id = (SELECT id FROM bss_company WHERE company_name = 'XX公司') AND delete_ts IS NULL GROUP BY service_area_type;"
  },
  {
    "question": "最近一周新增的各公司服务区数量统计",
    "sql": "SELECT bc.company_name AS 公司名称, COUNT(bsa.id) AS 新增数量 FROM bss_service_area bsa JOIN bss_company bc ON bsa.company_id = bc.id WHERE bsa.create_ts >= CURRENT_DATE - 7 AND bsa.delete_ts IS NULL AND bc.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 新增数量 DESC;"
  },
  {
    "question": "各公司服务区日均订单数对比分析",
    "sql": "SELECT bc.company_name AS 公司名称, AVG(bdd.order_sum) AS 日均订单数 FROM bss_business_day_data bdd JOIN bss_service_area bsa ON bdd.service_no = bsa.service_area_no JOIN bss_company bc ON bsa.company_id = bc.id WHERE bdd.delete_ts IS NULL AND bsa.delete_ts IS NULL AND bc.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 日均订单数 DESC;"
  },
  {
    "question": "各区域服务区覆盖率（按路段关联数量统计）",
    "sql": "SELECT bc.company_name AS 公司名称, COUNT(DISTINCT bsr.section_route_id) AS 覆盖路段数 FROM bss_section_route_area_link bsral JOIN bss_service_area bsa ON bsral.service_area_id = bsa.id JOIN bss_company bc ON bsa.company_id = bc.id WHERE bsral.delete_ts IS NULL AND bsa.delete_ts IS NULL AND bc.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 覆盖路段数 DESC;"
  },
  {
    "question": "各公司正常运营与非正常运营服务区数量对比",
    "sql": "SELECT bc.company_name AS 公司名称, bsa.service_state AS 运营状态, COUNT(*) AS 数量 FROM bss_service_area bsa JOIN bss_company bc ON bsa.company_id = bc.id WHERE bsa.delete_ts IS NULL AND bc.delete_ts IS NULL GROUP BY bc.company_name, bsa.service_state ORDER BY 公司名称, 数量 DESC;"
  },
  {
    "question": "2023年Q2各公司服务区总支付金额环比分析",
    "sql": "SELECT bc.company_name AS 公司名称, SUM(CASE WHEN EXTRACT(QUARTER FROM bdd.oper_date) = 2 THEN bdd.pay_sum ELSE 0 END) AS 第二季度金额, SUM(CASE WHEN EXTRACT(QUARTER FROM bdd.oper_date) = 1 THEN bdd.pay_sum ELSE 0 END) AS 第一季度金额 FROM bss_business_day_data bdd JOIN bss_service_area bsa ON bdd.service_no = bsa.service_area_no JOIN bss_company bc ON bsa.company_id = bc.id WHERE bdd.oper_date BETWEEN '2023-01-01' AND '2023-06-30' AND bdd.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 第二季度金额 DESC;"
  },
  {
    "question": "各公司管理的服务区车辆流量TOP5统计",
    "sql": "SELECT bc.company_name AS 公司名称, SUM(cc.customer_count) AS 总车流量 FROM bss_car_day_count cc JOIN bss_service_area bsa ON cc.service_area_id = bsa.id JOIN bss_company bc ON bsa.company_id = bc.id WHERE cc.count_date = CURRENT_DATE - 1 AND cc.delete_ts IS NULL AND bsa.delete_ts IS NULL GROUP BY bc.company_name ORDER BY 总车流量 DESC LIMIT 5;"
  },
  {
    "question": "查找近30天无业务数据的服务区清单",
    "sql": "SELECT bsa.service_area_name AS 服务区名称, bc.company_name AS 管理公司 FROM bss_service_area bsa LEFT JOIN bss_business_day_data bdd ON bsa.service_area_no = bdd.service_no AND bdd.oper_date >= CURRENT_DATE - 30 JOIN bss_company bc ON bsa.company_id = bc.id WHERE bdd.id IS NULL AND bsa.delete_ts IS NULL AND bc.delete_ts IS NULL LIMIT 10;"
  },
  {
    "question": "统计各路段路线关联的服务区数量，评估服务区覆盖密度",
    "sql": "SELECT sr.route_name AS 路线名称, COUNT(link.service_area_id) AS 服务区数量 FROM bss_section_route sr LEFT JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE sr.delete_ts IS NULL GROUP BY sr.route_name ORDER BY 服务区数量 DESC;"
  },
  {
    "question": "查询最近一个月新增的路段路线与服务区关联关系",
    "sql": "SELECT sa.service_area_name AS 服务区名称, sr.section_name AS 路段名称, sr.route_name AS 路线名称 FROM bss_section_route_area_link link JOIN bss_section_route sr ON link.section_route_id = sr.id JOIN bss_service_area sa ON link.service_area_id = sa.id WHERE sr.create_ts >= NOW() - INTERVAL '1 month' AND sr.delete_ts IS NULL AND sa.delete_ts IS NULL ORDER BY sr.create_ts DESC LIMIT 10;"
  },
  {
    "question": "分析各服务区关联的路段路线数量TOP10",
    "sql": "SELECT sa.service_area_name AS 服务区名称, COUNT(sr.id) AS 关联路段数 FROM bss_section_route_area_link link JOIN bss_service_area sa ON link.service_area_id = sa.id JOIN bss_section_route sr ON link.section_route_id = sr.id WHERE sa.delete_ts IS NULL GROUP BY sa.service_area_name ORDER BY 关联路段数 DESC LIMIT 10;"
  },
  {
    "question": "统计无服务区覆盖的路段路线信息",
    "sql": "SELECT sr.section_name AS 路段名称, sr.route_name AS 路线名称 FROM bss_section_route sr LEFT JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE link.section_route_id IS NULL AND sr.delete_ts IS NULL ORDER BY sr.create_ts DESC;"
  },
  {
    "question": "分析不同路线名称对应的服务区平均覆盖密度",
    "sql": "SELECT route_name AS 路线名称, AVG(service_count) AS 平均服务区密度 FROM (SELECT sr.route_name, COUNT(link.service_area_id) AS service_count FROM bss_section_route sr LEFT JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE sr.delete_ts IS NULL GROUP BY sr.route_name, sr.id) sub GROUP BY route_name HAVING AVG(service_count) > 0 ORDER BY 平均服务区密度 DESC;"
  },
  {
    "question": "查询包含服务区最多的3个路段编号及其覆盖情况",
    "sql": "SELECT sr.code AS 路段编号, sr.section_name AS 路段名称, COUNT(link.service_area_id) AS 服务区数量 FROM bss_section_route sr JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE sr.delete_ts IS NULL GROUP BY sr.code, sr.section_name ORDER BY 服务区数量 DESC LIMIT 3;"
  },
  {
    "question": "分析服务区关联路段的创建时间分布情况",
    "sql": "SELECT EXTRACT(MONTH FROM sr.create_ts) AS 月份, COUNT(*) AS 新增路段数 FROM bss_section_route sr JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE sr.delete_ts IS NULL GROUP BY 月份 ORDER BY 月份;"
  },
  {
    "question": "统计双向路线（上下行）的服务区覆盖对称性",
    "sql": "SELECT sr.code AS 路段编号, COUNT(DISTINCT CASE WHEN sr.route_name LIKE '%上行%' THEN link.service_area_id END) AS 上行服务区数, COUNT(DISTINCT CASE WHEN sr.route_name LIKE '%下行%' THEN link.service_area_id END) AS 下行服务区数 FROM bss_section_route sr JOIN bss_section_route_area_link link ON sr.id = link.section_route_id WHERE sr.delete_ts IS NULL AND (sr.route_name LIKE '%上行%' OR sr.route_name LIKE '%下行%') GROUP BY sr.code HAVING COUNT(DISTINCT CASE WHEN sr.route_name LIKE '%上行%' THEN link.service_area_id END) != COUNT(DISTINCT CASE WHEN sr.route_name LIKE '%下行%' THEN link.service_area_id END);"
  },
  {
    "question": "查询最近7天内未产生业务数据的服务区关联路段",
    "sql": "SELECT sr.section_name AS 路段名称, sa.service_area_name AS 服务区名称 FROM bss_section_route_area_link link JOIN bss_section_route sr ON link.section_route_id = sr.id JOIN bss_service_area sa ON link.service_area_id = sa.id LEFT JOIN bss_business_day_data business ON sa.id = business.service_no::uuid AND business.oper_date >= NOW() - INTERVAL '7 days' WHERE business.id IS NULL AND sr.delete_ts IS NULL AND sa.delete_ts IS NULL GROUP BY sr.section_name, sa.service_area_name;"
  },
  {
    "question": "分析不同运营状态服务区的路段覆盖分布",
    "sql": "SELECT sa.service_state AS 运营状态, COUNT(DISTINCT sr.id) AS 覆盖路段数, COUNT(DISTINCT link.service_area_id) AS 服务区数量 FROM bss_section_route sr JOIN bss_section_route_area_link link ON sr.id = link.section_route_id JOIN bss_service_area sa ON link.service_area_id = sa.id WHERE sr.delete_ts IS NULL AND sa.delete_ts IS NULL GROUP BY sa.service_state ORDER BY 覆盖路段数 DESC;"
  },
  {
    "question": "各服务区微信支付渗透率及订单占比分析（按订单量排序）",
    "sql": "SELECT service_name AS \"服务区名称\", SUM(wx_order)/SUM(order_sum) AS \"微信支付渗透率\" FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY \"微信支付渗透率\" DESC;"
  },
  {
    "question": "不同地区支付宝与现金支付金额对比（取平均值排序）",
    "sql": "SELECT sa.service_area_type AS \"服务区类型\", AVG(bd.zfb) AS \"平均支付宝支付\", AVG(bd.rmb) AS \"平均现金支付\" FROM bss_business_day_data bd JOIN bss_service_area sa ON bd.service_no = sa.service_area_no WHERE bd.delete_ts IS NULL AND sa.delete_ts IS NULL GROUP BY sa.service_area_type ORDER BY \"平均支付宝支付\" DESC;"
  },
  {
    "question": "档口支付方式金额占比TOP5（按微信支付优先级排序）",
    "sql": "SELECT branch_name AS \"档口名称\", wx/SUM(pay_sum) OVER(PARTITION BY branch_name) AS \"微信占比\" FROM bss_business_day_data WHERE delete_ts IS NULL ORDER BY \"微信占比\" DESC LIMIT 5;"
  },
  {
    "question": "最近7天各支付类型订单趋势变化（按日期聚合）",
    "sql": "SELECT oper_date AS \"统计日期\", SUM(wx_order) AS \"微信订单\", SUM(zf_order) AS \"支付宝订单\", SUM(rmb_order) AS \"现金订单\" FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - INTERVAL '7 days' GROUP BY oper_date ORDER BY oper_date;"
  },
  {
    "question": "现金支付占比超过30%的服务区及天数统计",
    "sql": "SELECT service_name AS \"服务区名称\", COUNT(*) AS \"高现金支付天数\" FROM bss_business_day_data WHERE delete_ts IS NULL AND rmb_order/order_sum > 0.3 GROUP BY service_name ORDER BY \"高现金支付天数\" DESC;"
  },
  {
    "question": "不同档口微信支付平均金额对比（取TOP10）",
    "sql": "SELECT branch_name AS \"档口名称\", AVG(wx) AS \"平均微信支付金额\" FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name ORDER BY \"平均微信支付金额\" DESC LIMIT 10;"
  },
  {
    "question": "服务区各支付方式渗透率对比（按服务类型分组）",
    "sql": "SELECT sa.service_area_type AS \"服务区类型\", bd.service_name AS \"服务区名称\", SUM(xs_order)/SUM(order_sum) AS \"行吧支付渗透率\" FROM bss_business_day_data bd JOIN bss_service_area sa ON bd.service_no = sa.service_area_no WHERE bd.delete_ts IS NULL GROUP BY sa.service_area_type, bd.service_name ORDER BY sa.service_area_type, \"行吧支付渗透率\" DESC;"
  },
  {
    "question": "支付宝订单占比最高的前三天数据明细",
    "sql": "SELECT oper_date AS \"统计日期\", service_name AS \"服务区名称\", zf_order AS \"支付宝订单数\", order_sum AS \"总订单数\" FROM bss_business_day_data WHERE delete_ts IS NULL ORDER BY zf_order/order_sum DESC LIMIT 3;"
  },
  {
    "question": "行吧支付使用率最低的五个服务区（按订单量）",
    "sql": "SELECT service_name AS \"服务区名称\", SUM(xs_order)/SUM(order_sum) AS \"行吧支付渗透率\" FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY \"行吧支付渗透率\" ASC LIMIT 5;"
  },
  {
    "question": "档口支付结构稳定性分析（计算各支付方式金额方差）",
    "sql": "SELECT branch_name AS \"档口名称\", VARIANCE(wx) AS \"微信支付方差\", VARIANCE(zf) AS \"支付宝支付方差\" FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name ORDER BY \"微信支付方差\" + \"支付宝支付方差\" DESC LIMIT 10;"
  }
]
-- Schema Tools生成的主题元数据
-- 业务背景: 高速公路服务区管理系统
-- 生成时间: 2025-07-03 00:41:43
-- 数据库: highway_db

-- 创建表（如果不存在）
CREATE TABLE IF NOT EXISTS metadata (
    id SERIAL PRIMARY KEY,    -- 主键
    topic_name VARCHAR(100) NOT NULL,  -- 业务主题名称
    description TEXT,                  -- 业务主体说明
    related_tables TEXT[],			  -- 相关表名
    biz_entities TEXT[],               -- 主要业务实体名称
    biz_metrics TEXT[],                -- 主要业务指标名称
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP    -- 插入时间
);

-- 插入主题数据
INSERT INTO metadata(topic_name, description, related_tables, biz_entities, biz_metrics) VALUES
(
  '日营收分析',
  '基于 bss_business_day_data 表分析各服务区/档口每日营收结构、支付方式占比及订单量变化趋势',
  'bss_business_day_data,bss_service_area,bss_service_area_mapper',
  '服务区,档口,支付渠道,日期',
  '营收趋势,渠道占比,区域对比'
);

INSERT INTO metadata(topic_name, description, related_tables, biz_entities, biz_metrics) VALUES
(
  '车流监测',
  '通过 bss_car_day_count 表统计各服务区车流量分布，分析危化品/城际车辆通行规律',
  'bss_car_day_count,bss_service_area',
  '服务区,车辆类型,日期,地理坐标',
  '流量趋势,车型分布,热点排名'
);

INSERT INTO metadata(topic_name, description, related_tables, biz_entities, biz_metrics) VALUES
(
  '公司绩效',
  '结合 bss_company 和 bss_service_area 表评估各分公司管辖服务区的运营效能和服务质量',
  'bss_company,bss_service_area,bss_business_day_data',
  '分公司,服务区,服务类型,运营状态',
  '效能指数,服务达标率,营收贡献'
);

INSERT INTO metadata(topic_name, description, related_tables, biz_entities, biz_metrics) VALUES
(
  '路线关联',
  '通过 bss_section_route 和 bss_section_route_area_link 分析路线与服务区的联动效应',
  'bss_section_route,bss_section_route_area_link,bss_car_day_count',
  '路线,路段,服务区,车流量',
  '路线贡献度,服务区覆盖率,车流密度'
);

INSERT INTO metadata(topic_name, description, related_tables, biz_entities, biz_metrics) VALUES
(
  '数据溯源',
  '基于 bss_service_area_mapper 分析不同来源系统（驿购/驿美等）的数据覆盖完整性和更新时效性',
  'bss_service_area_mapper,bss_business_day_data,bss_car_day_count',
  '数据源系统,服务区,编码类型,更新周期',
  '数据完整性,更新及时性,来源分布'
);


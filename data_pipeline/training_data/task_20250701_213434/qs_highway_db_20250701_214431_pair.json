[
  {
    "question": "统计2023年4月各服务区微信支付占比，并按占比降序排列",
    "sql": "SELECT service_name AS 服务区名称, SUM(wx)/SUM(pay_sum)*100 AS 微信占比 FROM bss_business_day_data WHERE oper_date BETWEEN '2023-04-01' AND '2023-04-30' AND delete_ts IS NULL GROUP BY service_name ORDER BY 微信占比 DESC;"
  },
  {
    "question": "对比2023年第一季度各档口支付宝订单量TOP10",
    "sql": "SELECT branch_name AS 档口名称, SUM(zf_order) AS 支付宝订单量 FROM bss_business_day_data WHERE oper_date BETWEEN '2023-01-01' AND '2023-03-31' AND delete_ts IS NULL GROUP BY branch_name ORDER BY 支付宝订单量 DESC LIMIT 10;"
  },
  {
    "question": "筛选现金支付金额占比超过20%的服务区（2023年数据）",
    "sql": "SELECT service_name AS 服务区名称, SUM(rmb)/SUM(pay_sum)*100 AS 现金占比 FROM bss_business_day_data WHERE oper_date >= '2023-01-01' AND delete_ts IS NULL GROUP BY service_name HAVING SUM(rmb)/SUM(pay_sum) > 0.2;"
  },
  {
    "question": "分析2023年Q1各支付类型月均交易金额分布",
    "sql": "SELECT DATE_TRUNC('month', oper_date) AS 月份, AVG(wx) AS 平均微信支付, AVG(zfb) AS 平均支付宝支付, AVG(rmb) AS 平均现金支付 FROM bss_business_day_data WHERE oper_date BETWEEN '2023-01-01' AND '2023-03-31' AND delete_ts IS NULL GROUP BY 月份 ORDER BY 月份;"
  },
  {
    "question": "找出微信支付订单量最低的5个服务区（2023年数据）",
    "sql": "SELECT service_name AS 服务区名称, SUM(wx_order) AS 微信订单量 FROM bss_business_day_data WHERE oper_date >= '2023-01-01' AND delete_ts IS NULL GROUP BY service_name ORDER BY 微信订单量 ASC LIMIT 5;"
  },
  {
    "question": "统计各档口行吧支付使用情况并按金额排序TOP5",
    "sql": "SELECT branch_name AS 档口名称, SUM(xs) AS 行吧支付总额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name ORDER BY 行吧支付总额 DESC LIMIT 5;"
  },
  {
    "question": "计算2023年4月各支付类型的平均订单金额",
    "sql": "SELECT SUM(wx)/SUM(wx_order) AS 微信单均金额, SUM(zfb)/SUM(zf_order) AS 支付宝单均金额, SUM(rmb)/SUM(rmb_order) AS 现金单均金额 FROM bss_business_day_data WHERE oper_date BETWEEN '2023-04-01' AND '2023-04-30' AND delete_ts IS NULL;"
  },
  {
    "question": "分析服务区各支付方式订单量是否超过全量平均值",
    "sql": "SELECT service_name AS 服务区名称, SUM(wx_order) > (SELECT AVG(wx_order) FROM bss_business_day_data WHERE delete_ts IS NULL) AS 微信超均值, SUM(zf_order) > (SELECT AVG(zf_order) FROM bss_business_day_data WHERE delete_ts IS NULL) AS 支付宝超均值 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name;"
  },
  {
    "question": "统计2023年4月每日微信支付金额趋势",
    "sql": "SELECT oper_date AS 日期, SUM(wx) AS 微信支付总额 FROM bss_business_day_data WHERE oper_date BETWEEN '2023-04-01' AND '2023-04-30' AND delete_ts IS NULL GROUP BY oper_date ORDER BY 日期;"
  },
  {
    "question": "分析金豆支付使用情况并找出TOP1服务区",
    "sql": "SELECT service_name AS 服务区名称, SUM(jd) AS 金豆支付总额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY 金豆支付总额 DESC LIMIT 1;"
  },
  {
    "question": "统计各服务区2023年4月1日当天车辆总数并按数量降序排列",
    "sql": "SELECT service_area_id AS \"服务区ID\", SUM(customer_count) AS \"总车流量\" FROM bss_car_day_count WHERE count_date = '2023-04-01' AND delete_ts IS NULL GROUP BY service_area_id ORDER BY \"总车流量\" DESC;"
  },
  {
    "question": "分析庐山服务区2023年不同车辆类型占比分布",
    "sql": "SELECT car_type AS \"车辆类型\", SUM(customer_count) AS \"数量\", ROUND(SUM(customer_count)*100/(SELECT SUM(customer_count) FROM bss_car_day_count WHERE service_area_id = '庐山服务区ID' AND delete_ts IS NULL),2) AS \"占比(%)\" FROM bss_car_day_count WHERE service_area_id = '庐山服务区ID' AND delete_ts IS NULL GROUP BY car_type;"
  },
  {
    "question": "查询宜春服务区近7天每日车流量趋势（按统计日期）",
    "sql": "SELECT count_date AS \"统计日期\", SUM(customer_count) AS \"日车流量\" FROM bss_car_day_count WHERE service_area_id = '宜春服务区ID' AND count_date >= CURRENT_DATE - 7 AND delete_ts IS NULL GROUP BY count_date ORDER BY \"统计日期\";"
  },
  {
    "question": "找出2023年4月车流高峰前5的服务区及对应峰值日期",
    "sql": "SELECT service_area_id AS \"服务区ID\", count_date AS \"峰值日期\", customer_count AS \"车流量\" FROM bss_car_day_count WHERE count_date BETWEEN '2023-04-01' AND '2023-04-30' AND delete_ts IS NULL ORDER BY \"车流量\" DESC LIMIT 5;"
  },
  {
    "question": "对比城际车辆与过境车辆在各服务区的月均车流量差异",
    "sql": "SELECT service_area_id AS \"服务区ID\", car_type AS \"车辆类型\", AVG(customer_count) AS \"月均车流量\" FROM bss_car_day_count WHERE car_type IN ('城际','过境') AND delete_ts IS NULL GROUP BY \"服务区ID\", \"车辆类型\" ORDER BY \"服务区ID\", \"车辆类型\";"
  },
  {
    "question": "统计各服务区危化品车辆出现频次TOP3的日期",
    "sql": "SELECT * FROM (SELECT service_area_id AS \"服务区ID\", count_date AS \"统计日期\", customer_count AS \"车流量\", RANK() OVER(PARTITION BY service_area_id ORDER BY customer_count DESC) AS \"排名\" FROM bss_car_day_count WHERE car_type = '危化品' AND delete_ts IS NULL) t WHERE \"排名\" <=3 ORDER BY \"服务区ID\", \"排名\";"
  },
  {
    "question": "分析2023年各季度不同车辆类型占比变化趋势",
    "sql": "SELECT DATE_TRUNC('quarter', count_date) AS \"季度\", car_type AS \"车辆类型\", SUM(customer_count) AS \"累计数量\" FROM bss_car_day_count WHERE count_date >= '2023-01-01' AND delete_ts IS NULL GROUP BY \"季度\", \"车辆类型\" ORDER BY \"季度\", \"车辆类型\";"
  },
  {
    "question": "查询单日车流量超过5000的服务区及对应日期",
    "sql": "SELECT service_area_id AS \"服务区ID\", count_date AS \"统计日期\", customer_count AS \"车流量\" FROM bss_car_day_count WHERE customer_count > 5000 AND delete_ts IS NULL ORDER BY \"统计日期\" DESC;"
  },
  {
    "question": "比较不同车辆类型在工作日与非工作日的平均车流量差异",
    "sql": "SELECT car_type AS \"车辆类型\", AVG(CASE WHEN EXTRACT(ISODOW FROM count_date) IN (6,7) THEN customer_count ELSE 0 END) AS \"非工作日均值\", AVG(CASE WHEN EXTRACT(ISODOW FROM count_date) NOT IN (6,7) THEN customer_count ELSE 0 END) AS \"工作日均值\" FROM bss_car_day_count WHERE delete_ts IS NULL GROUP BY \"车辆类型\";"
  },
  {
    "question": "统计各服务区连续3天及以上日车流量破千的记录",
    "sql": "SELECT * FROM (SELECT service_area_id AS \"服务区ID\", count_date AS \"统计日期\", customer_count AS \"车流量\", COUNT(*) OVER(PARTITION BY service_area_id ORDER BY count_date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS \"连续达标天数\" FROM bss_car_day_count WHERE customer_count >= 1000 AND delete_ts IS NULL) t WHERE \"连续达标天数\" >=3;"
  },
  {
    "question": "最近7天各服务区日均营收对比，按日均营收从高到低排列前10名",
    "sql": "SELECT service_name AS 服务区名称, AVG(pay_sum) AS 日均营收 FROM bss_business_day_data WHERE oper_date >= CURRENT_DATE - 7 AND delete_ts IS NULL GROUP BY service_name ORDER BY 日均营收 DESC LIMIT 10;"
  },
  {
    "question": "上月各服务区总订单量排名，显示订单量最高的前5个服务区",
    "sql": "SELECT service_name AS 服务区名称, SUM(order_sum) AS 总订单量 FROM bss_business_day_data WHERE oper_date >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') AND oper_date < DATE_TRUNC('month', CURRENT_DATE) AND delete_ts IS NULL GROUP BY service_name ORDER BY 总订单量 DESC LIMIT 5;"
  },
  {
    "question": "本月已开业天数大于15天的服务区中，日均营收增长率超过20%的服务区有哪些",
    "sql": "SELECT service_name AS 服务区名称, (AVG(CASE WHEN oper_date >= DATE_TRUNC('month', CURRENT_DATE) THEN pay_sum ELSE 0 END) / NULLIF(AVG(CASE WHEN oper_date < DATE_TRUNC('month', CURRENT_DATE) AND oper_date >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month' THEN pay_sum ELSE 0 END), 0) - 1) * 100 AS 营收增长率百分比 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name HAVING COUNT(DISTINCT CASE WHEN oper_date >= DATE_TRUNC('month', CURRENT_DATE) THEN oper_date END) > 15 AND (AVG(CASE WHEN oper_date >= DATE_TRUNC('month', CURRENT_DATE) THEN pay_sum ELSE 0 END) / NULLIF(AVG(CASE WHEN oper_date < DATE_TRUNC('month', CURRENT_DATE) AND oper_date >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month' THEN pay_sum ELSE 0 END), 0) - 1) * 100 > 20;"
  },
  {
    "question": "2023年4月1日单日营收最低的5个服务区及对应营收金额",
    "sql": "SELECT service_name AS 服务区名称, pay_sum AS 营收金额 FROM bss_business_day_data WHERE oper_date = '2023-04-01' AND delete_ts IS NULL ORDER BY pay_sum ASC LIMIT 5;"
  },
  {
    "question": "最近30天各档口日均营收排名，显示前10名档口信息",
    "sql": "SELECT branch_name AS 档口名称, service_name AS 服务区名称, AVG(pay_sum) AS 日均营收 FROM bss_business_day_data WHERE oper_date >= CURRENT_DATE - 30 AND delete_ts IS NULL GROUP BY branch_name, service_name ORDER BY 日均营收 DESC LIMIT 10;"
  },
  {
    "question": "2023年3月各服务区总营收及订单量统计，按订单量降序排列",
    "sql": "SELECT service_name AS 服务区名称, SUM(pay_sum) AS 总营收, SUM(order_sum) AS 总订单量 FROM bss_business_day_data WHERE EXTRACT(YEAR FROM oper_date) = 2023 AND EXTRACT(MONTH FROM oper_date) = 3 AND delete_ts IS NULL GROUP BY service_name ORDER BY 总订单量 DESC;"
  },
  {
    "question": "连续7天日均营收超过1万元的服务区有哪些",
    "sql": "SELECT service_name AS 服务区名称 FROM (SELECT service_name, oper_date, AVG(pay_sum) OVER(PARTITION BY service_name ORDER BY oper_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS \"7日移动平均\" FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - 30) t WHERE \"7日移动平均\" > 10000 GROUP BY service_name;"
  },
  {
    "question": "最近一周各服务区微信支付占比分析，按占比高低排序",
    "sql": "SELECT service_name AS 服务区名称, SUM(wx) / SUM(pay_sum) * 100 AS 微信支付占比百分比 FROM bss_business_day_data WHERE oper_date >= CURRENT_DATE - 7 AND delete_ts IS NULL GROUP BY service_name ORDER BY 微信支付占比百分比 DESC;"
  },
  {
    "question": "本周（截至昨日）与上周相同时段营收环比增长率分析",
    "sql": "SELECT service_name AS 服务区名称, (SUM(CASE WHEN oper_date >= CURRENT_DATE - 7 AND oper_date < CURRENT_DATE THEN pay_sum ELSE 0 END) / NULLIF(SUM(CASE WHEN oper_date >= CURRENT_DATE - 14 AND oper_date < CURRENT_DATE - 7 THEN pay_sum ELSE 0 END), 0) - 1) * 100 AS 环比增长率百分比 FROM bss_business_day_data WHERE oper_date >= CURRENT_DATE - 14 AND delete_ts IS NULL GROUP BY service_name ORDER BY 环比增长率百分比 DESC;"
  },
  {
    "question": "宜春服务区各档口2023年Q1季度总营收分布，按档口营收降序排列",
    "sql": "SELECT branch_name AS 档口名称, SUM(pay_sum) AS 总营收 FROM bss_business_day_data WHERE service_name = '宜春服务区' AND oper_date >= '2023-01-01' AND oper_date <= '2023-03-31' AND delete_ts IS NULL GROUP BY branch_name ORDER BY 总营收 DESC;"
  },
  {
    "question": "统计各档口单位面积收益排名（按总支付金额降序排列前10）",
    "sql": "SELECT branch_name AS 档口名称, SUM(pay_sum) AS 总支付金额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name ORDER BY 总支付金额 DESC LIMIT 10;"
  },
  {
    "question": "分析各档口客单价（总支付金额除以订单总数）",
    "sql": "SELECT branch_name AS 档口名称, SUM(pay_sum) / SUM(order_sum) AS 客单价 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name;"
  },
  {
    "question": "近一周每日总支付金额趋势分析",
    "sql": "SELECT oper_date AS 日期, SUM(pay_sum) AS 日总支付金额 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date >= CURRENT_DATE - INTERVAL '7 days' GROUP BY oper_date ORDER BY 日期;"
  },
  {
    "question": "对比各服务区总支付金额及档口平均收益",
    "sql": "SELECT service_name AS 服务区名称, SUM(pay_sum) AS 总支付金额, AVG(pay_sum) AS 平均支付金额 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY 总支付金额 DESC;"
  },
  {
    "question": "各档口微信支付金额占比分析",
    "sql": "SELECT branch_name AS 档口名称, SUM(wx) / SUM(pay_sum) * 100 AS 微信占比百分比 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name;"
  },
  {
    "question": "订单数量最多的Top 5档口排名",
    "sql": "SELECT branch_name AS 档口名称, SUM(order_sum) AS 总订单数 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY branch_name ORDER BY 总订单数 DESC LIMIT 5;"
  },
  {
    "question": "2023年第一季度（1-3月）各月总支付金额趋势",
    "sql": "SELECT EXTRACT(MONTH FROM oper_date) AS 月份, SUM(pay_sum) AS 总支付金额 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY 月份 ORDER BY 月份;"
  },
  {
    "question": "客单价最低的5个服务区明细",
    "sql": "SELECT service_name AS 服务区名称, SUM(pay_sum) / SUM(order_sum) AS 客单价 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name ORDER BY 客单价 ASC LIMIT 5;"
  },
  {
    "question": "各服务区支付宝支付金额占比超过20%的记录",
    "sql": "SELECT service_name AS 服务区名称, SUM(zfb) / SUM(pay_sum) * 100 AS 支付宝占比 FROM bss_business_day_data WHERE delete_ts IS NULL GROUP BY service_name HAVING SUM(zfb) / SUM(pay_sum) > 0.2 ORDER BY 支付宝占比 DESC;"
  },
  {
    "question": "2023-04-01当天各档口支付金额及订单数明细",
    "sql": "SELECT branch_name AS 档口名称, pay_sum AS 当日支付金额, order_sum AS 当日订单数 FROM bss_business_day_data WHERE delete_ts IS NULL AND oper_date = '2023-04-01' ORDER BY 当日支付金额 DESC;"
  },
  {
    "question": "不同车辆类型在消费金额上的差异如何？",
    "sql": "SELECT car.car_type AS 车辆类型, SUM(bus.pay_sum) AS 总消费金额, SUM(car.customer_count) AS 总停留车辆数, SUM(bus.pay_sum)/SUM(car.customer_count) AS 人均消费 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY car.car_type ORDER BY 总消费金额 DESC;"
  },
  {
    "question": "各车型消费频次（订单数/车辆数）排名如何？",
    "sql": "SELECT car.car_type AS 车辆类型, SUM(bus.order_sum) AS 总订单数, SUM(car.customer_count) AS 总停留车辆数, SUM(bus.order_sum)::numeric/SUM(car.customer_count) AS 消费频次 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY car.car_type ORDER BY 消费频次 DESC;"
  },
  {
    "question": "危化品车辆停留期间每日人均消费趋势如何？",
    "sql": "SELECT car.count_date AS 统计日期, SUM(bus.pay_sum)/SUM(car.customer_count) AS 人均消费 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.car_type = '危化品' AND car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY car.count_date ORDER BY 统计日期;"
  },
  {
    "question": "城际车辆在各服务区的平均消费金额TOP10是哪些？",
    "sql": "SELECT bus.service_name AS 服务区名称, AVG(bus.pay_sum) AS 平均消费金额 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date AND car.service_area_id = bus.id WHERE car.car_type = '城际' AND car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY bus.service_name ORDER BY 平均消费金额 DESC LIMIT 10;"
  },
  {
    "question": "过境车辆消费中微信支付占比超过50%的日期有哪些？",
    "sql": "SELECT car.count_date AS 统计日期, SUM(bus.wx)/SUM(bus.pay_sum) AS 微信支付占比 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.car_type = '过境' AND car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY car.count_date HAVING SUM(bus.wx)/SUM(bus.pay_sum) > 0.5 ORDER BY 统计日期;"
  },
  {
    "question": "各车型消费转化率（订单数/车辆数）对比情况如何？",
    "sql": "SELECT car.car_type AS 车辆类型, SUM(bus.order_sum) AS 总订单数, SUM(car.customer_count) AS 总停留车辆数, SUM(bus.order_sum)::numeric/SUM(car.customer_count) AS 消费转化率 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY car.car_type ORDER BY 消费转化率 DESC;"
  },
  {
    "question": "2023年春节期间各车型总消费金额是多少？",
    "sql": "SELECT car.car_type AS 车辆类型, SUM(bus.pay_sum) AS 总消费金额 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL AND bus.oper_date BETWEEN '2023-01-20' AND '2023-01-30' GROUP BY car.car_type ORDER BY 总消费金额 DESC;"
  },
  {
    "question": "各服务区中哪种车型消费金额占比最高？",
    "sql": "WITH ranked_data AS (SELECT bus.service_name AS 服务区名称, car.car_type AS 车辆类型, SUM(bus.pay_sum) AS 总消费金额, RANK() OVER (PARTITION BY bus.service_name ORDER BY SUM(bus.pay_sum) DESC) AS 排名 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date AND car.service_area_id = bus.id WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY bus.service_name, car.car_type) SELECT 服务区名称, 车辆类型, 总消费金额 FROM ranked_data WHERE 排名 = 1 ORDER BY 总消费金额 DESC;"
  },
  {
    "question": "每日车辆数与当日总消费金额的相关性如何？",
    "sql": "SELECT CORR(total_cars, total_pay) AS 相关性系数 FROM (SELECT count_date, SUM(customer_count) AS total_cars, SUM(pay_sum) AS total_pay FROM bss_car_day_count car JOIN bss_business_day_data bus ON count_date = oper_date WHERE car.delete_ts IS NULL AND bus.delete_ts IS NULL GROUP BY count_date) AS daily_data;"
  },
  {
    "question": "最近一周其他类型车辆消费订单数量变化趋势如何？",
    "sql": "SELECT car.count_date AS 统计日期, SUM(bus.order_sum) AS 总订单数 FROM bss_car_day_count car JOIN bss_business_day_data bus ON car.count_date = bus.oper_date WHERE car.car_type = '其他' AND car.delete_ts IS NULL AND bus.delete_ts IS NULL AND car.count_date >= CURRENT_DATE - 7 GROUP BY car.count_date ORDER BY 统计日期;"
  }
]